# Destiny.OS - 구현 계획

## 마일스톤 개요

| Phase | 기간 | 주요 내용 |
|-------|------|----------|
| Phase 1 | 2주 | Foundation - 프로젝트 셋업, 핵심 알고리즘 |
| Phase 2 | 3주 | Core Features - 사주/MBTI/운세/대운 |
| Phase 3 | 2주 | Advanced Features - 궁합/AI상담/공유 |
| Phase 4 | 2주 | Polish & Launch - UI개선/테스트/배포 |

**총 예상 기간**: 9주

---

## Phase 1: Foundation (2주)

### Week 1: 프로젝트 셋업

#### Day 1-2: 환경 구성
- [ ] Flutter 프로젝트 생성
- [ ] Clean Architecture 디렉토리 구조 설정
- [ ] 필수 패키지 설치 (flutter_bloc, go_router, get_it 등)
- [ ] Firebase/Supabase 프로젝트 생성 및 연동
- [ ] Git 레포지토리 초기화

#### Day 3-4: 기본 설정
- [ ] 테마 시스템 구축 (컬러, 타이포그래피)
- [ ] Pretendard 폰트 추가
- [ ] 라우터 설정 (go_router)
- [ ] DI 컨테이너 설정 (GetIt)
- [ ] Error handling 기본 구조

#### Day 5: 공통 컴포넌트
- [ ] DestinyCard 위젯
- [ ] 기본 버튼 스타일
- [ ] 로딩 인디케이터
- [ ] 에러 다이얼로그

### Week 2: 핵심 알고리즘

#### Day 1-3: 만세력 계산기
- [ ] 천간/지지 상수 정의
- [ ] **60갑자 매핑 로직 (표준 테이블 기반)**
- [ ] 양력↔음력 변환
- [ ] 24절기 계산
- [ ] 경도 보정 (진태양시)

#### Day 4-5: 십성 계산기
- [ ] 십성 매핑 로직
- [ ] 오행 상생상극 관계
- [ ] 십성 분포 통계

---

## Phase 2: Core Features (3주)

### Week 3: 사주 분석 기능

- [ ] 입력 화면 (DateWheelPicker 커스텀 위젯)
- [ ] 시간 선택 (12시진)
- [ ] 성별/MBTI 선택
- [ ] SajuBloc 구현
- [ ] 결과 화면 (기본)

### Week 4: MBTI 연동 & 2026 운세

- [ ] Saju-to-MBTI 변환 로직
- [ ] Gap Score 계산
- [ ] 인사이트 텍스트 생성
- [ ] 병오년 데이터 모델
- [ ] 용신/기신 판단 로직
- [ ] 월별 에너지 계산
- [ ] EnergyChart 위젯

### Week 5: 대운 타임라인

- [ ] 대운 시작 나이 계산
- [ ] 순행/역행 결정 로직
- [ ] 대운 간지 도출
- [ ] 대운별 십성 분석
- [ ] 타임라인 UI (가로 스크롤)
- [ ] 결과 허브 통합

---

## Phase 3: Advanced Features (2주)

### Week 6: 궁합 & AI 상담

- [ ] 두 번째 사주 입력 UI
- [ ] 일주 궁합 계산 (합/충/형)
- [ ] 오행 균형 분석
- [ ] **AI 상담 서버리스 함수 구현**
- [ ] 상담 유형 선택 UI
- [ ] 프롬프트 템플릿 작성

### Week 7: 공유 기능 & 연동

- [ ] RepaintBoundary 캡처
- [ ] 9:16 카드 템플릿
- [ ] 인스타 스토리/카카오톡 공유
- [ ] Firebase 연동 완성
- [ ] 사용자 프로필 저장
- [ ] 상담 기록 저장/조회

---

## Phase 4: Polish & Launch (2주)

### Week 8: UI/UX 개선

- [ ] 페이지 전환 애니메이션
- [ ] 카드 플립 애니메이션
- [ ] 차트 드로잉 애니메이션
- [ ] 햅틱 피드백 적용
- [ ] 다크모드 지원 (선택)

### Week 9: 테스트 & 배포

- [ ] **만세력 정확도 검증 (10+ 샘플)**
- [ ] Unit 테스트
- [ ] Widget 테스트
- [ ] 통합 테스트
- [ ] 앱 아이콘 & 스플래시
- [ ] 스토어 스크린샷
- [ ] 개인정보처리방침/이용약관
- [ ] iOS/Android 빌드 배포

---

## 리스크 관리

### 기술 리스크

| 리스크 | 영향도 | 발생확률 | 대응 전략 |
|--------|--------|----------|----------|
| 만세력 계산 오류 | 높음 | 중간 | 표준 테이블 사용, 전문가 검증 |
| OpenAI API 비용 초과 | 중간 | 중간 | 서버리스 함수로 제어, 무료 횟수 제한 |
| 토스 미니앱 SDK 이슈 | 높음 | 중간 | 독립 앱 우선 개발, SDK 문서 사전 확인 |

### 일정 리스크

| 마일스톤 | 버퍼 | 대응 전략 |
|----------|------|----------|
| Phase 1 | +2일 | 기본 기능만 우선 |
| Phase 2 | +3일 | 대운은 Phase 3으로 이동 가능 |
| Phase 3 | +2일 | AI 상담 스펙 축소 가능 |
| Phase 4 | +3일 | 출시 후 업데이트로 처리 |

---

## 출시 전 체크리스트

### 필수
- [ ] 개인정보처리방침 작성
- [ ] 이용약관 작성
- [ ] 앱 심사 가이드라인 준수 확인
- [ ] 만세력 정확도 검증 (10+ 샘플)
- [ ] 크래시 리포트 연동 (Firebase Crashlytics 등)

### 권장
- [ ] 테스트 커버리지 70% 이상
- [ ] 성능 프로파일링
- [ ] 접근성 점검

---

## 테스트 케이스 (만세력)

```dart
// 검증해야 할 케이스
group('만세력 계산 테스트', () {
  test('윤달 처리', () {});
  test('야자시 처리 (23:00-00:00)', () {});
  test('입춘 전후 년주 변경', () {});
  test('절기 경계 월주 변경', () {});
  test('경도 보정 (서울 127.5도)', () {});
  test('시간 미입력 시 시주 null', () {});
});
```

---

## 의존성 패키지 (예정)

```yaml
dependencies:
  flutter_bloc: ^8.1.0
  equatable: ^2.0.0
  get_it: ^7.6.0
  go_router: ^12.0.0
  firebase_core: ^2.24.0
  firebase_auth: ^4.15.0
  cloud_firestore: ^4.13.0
  hive_flutter: ^1.1.0
  flutter_secure_storage: ^9.0.0
  fl_chart: ^0.65.0
  share_plus: ^7.2.0
  dio: ^5.3.0
  dartz: ^0.10.1
  intl: ^0.18.0

dev_dependencies:
  bloc_test: ^9.1.0
  mocktail: ^1.0.0
```
