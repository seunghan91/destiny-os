# Supabase í”„ë¡œì íŠ¸ ìƒì„± ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨

1. [Supabase ê³„ì • ìƒì„±](#supabase-ê³„ì •-ìƒì„±)
2. [ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±](#ìƒˆ-í”„ë¡œì íŠ¸-ìƒì„±)
3. [í”„ë¡œì íŠ¸ ì„¤ì •](#í”„ë¡œì íŠ¸-ì„¤ì •)
4. [API í‚¤ ë° URL í™•ì¸](#api-í‚¤-ë°-url-í™•ì¸)
5. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì •)
6. [ë¡œì»¬ í™˜ê²½ ì„¤ì •](#ë¡œì»¬-í™˜ê²½-ì„¤ì •)

---

## Supabase ê³„ì • ìƒì„±

### 1. Supabase ì›¹ì‚¬ì´íŠ¸ ì ‘ì†

https://supabase.com ì ‘ì†

### 2. íšŒì›ê°€ì…

**ë°©ë²• 1: GitHub ê³„ì •ìœ¼ë¡œ ê°€ì… (ê¶Œì¥)**
- "Start your project" í´ë¦­
- "Continue with GitHub" ì„ íƒ
- GitHub ê³„ì • ì—°ë™ ìŠ¹ì¸

**ë°©ë²• 2: ì´ë©”ì¼ë¡œ ê°€ì…**
- ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥
- ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
- ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ

---

## ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±

### 1. ëŒ€ì‹œë³´ë“œ ì ‘ì†

ë¡œê·¸ì¸ í›„ ìë™ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

### 2. "New Project" í´ë¦­

ì¢Œì¸¡ ìƒë‹¨ ë˜ëŠ” ì¤‘ì•™ì˜ "New Project" ë²„íŠ¼ í´ë¦­

### 3. í”„ë¡œì íŠ¸ ì •ë³´ ì…ë ¥

#### mbti_luck í”„ë¡œì íŠ¸ ì„¤ì • ì˜ˆì‹œ

| í•­ëª© | ê°’ | ì„¤ëª… |
|------|-----|------|
| **Organization** | ê¸°ì¡´ ì¡°ì§ ì„ íƒ ë˜ëŠ” ìƒˆë¡œ ìƒì„± | ë¬´ë£Œ í”Œëœì€ ì¡°ì§ë‹¹ 2ê°œ í”„ë¡œì íŠ¸ |
| **Project name** | `destiny-os-production` | í”„ë¡œì íŠ¸ ì´ë¦„ |
| **Database Password** | ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ìƒì„± | **ë°˜ë“œì‹œ ì•ˆì „í•˜ê²Œ ë³´ê´€** |
| **Region** | `Northeast Asia (Seoul)` | í•œêµ­ ì„œìš¸ ë¦¬ì „ ì„ íƒ (ë‚®ì€ ì§€ì—°ì‹œê°„) |
| **Pricing Plan** | `Free` | ë¬´ë£Œ í”Œëœ (í”„ë¡œí† íƒ€ì…ìš©) |

```
í”„ë¡œì íŠ¸ëª… ì¶”ì²œ:
- ê°œë°œ: destiny-os-dev
- ìŠ¤í…Œì´ì§•: destiny-os-staging
- í”„ë¡œë•ì…˜: destiny-os-production
```

### 4. "Create new project" í´ë¦­

í”„ë¡œì íŠ¸ ìƒì„± ì¤‘... (ì•½ 2-3ë¶„ ì†Œìš”)

---

## í”„ë¡œì íŠ¸ ì„¤ì •

### 1. í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œ í™•ì¸

ìƒì„± ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ í”„ë¡œì íŠ¸ ëŒ€ì‹œë³´ë“œë¡œ ì´ë™

### 2. ì£¼ìš” ë©”ë‰´ ì†Œê°œ

```
â”œâ”€â”€ Home - í”„ë¡œì íŠ¸ ê°œìš” ë° í†µê³„
â”œâ”€â”€ Table Editor - ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ê´€ë¦¬
â”œâ”€â”€ SQL Editor - SQL ì¿¼ë¦¬ ì‹¤í–‰
â”œâ”€â”€ Database - ìŠ¤í‚¤ë§ˆ, ë°±ì—…, ì—°ê²° ì„¤ì •
â”œâ”€â”€ Authentication - ì‚¬ìš©ì ì¸ì¦ ê´€ë¦¬
â”œâ”€â”€ Storage - íŒŒì¼ ì €ì¥ì†Œ
â”œâ”€â”€ Edge Functions - ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜
â”œâ”€â”€ Logs - ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§
â””â”€â”€ Settings - í”„ë¡œì íŠ¸ ì„¤ì •
```

---

## API í‚¤ ë° URL í™•ì¸

### 1. Settings > API ë©”ë‰´ ì´ë™

ì¢Œì¸¡ ì‚¬ì´ë“œë°” í•˜ë‹¨ **Settings** â†’ **API** í´ë¦­

### 2. Project URL ë³µì‚¬

```
https://YOUR_PROJECT_REF.supabase.co
```

ì˜ˆì‹œ:
```
https://rmqsukldnmileszpndgh.supabase.co
```

### 3. API Keys ë³µì‚¬

#### anon (public) key
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
- **ìš©ë„**: Flutter ì•±ì—ì„œ ì‚¬ìš© (ê³µê°œ ê°€ëŠ¥)
- **ê¶Œí•œ**: RLS ì •ì±…ì— ë”°ë¥¸ ì œí•œëœ ì ‘ê·¼

#### service_role key
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```
- **ìš©ë„**: Edge Functions, ë°±ì—”ë“œì—ì„œë§Œ ì‚¬ìš©
- **ê¶Œí•œ**: ëª¨ë“  ë°ì´í„° ì ‘ê·¼ ê°€ëŠ¥ (RLS ìš°íšŒ)
- âš ï¸ **ì ˆëŒ€ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œ ê¸ˆì§€**

### 4. `.env` íŒŒì¼ì— ì €ì¥

Flutter í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±:

```bash
# Supabase Configuration
SUPABASE_URL=https://YOUR_PROJECT_REF.supabase.co
SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# í† ìŠ¤í˜ì´ë¨¼ì¸  (ë‚˜ì¤‘ì— ì¶”ê°€)
TOSS_CLIENT_KEY=
TOSS_SECRET_KEY=
```

âš ï¸ **`.env` íŒŒì¼ì„ `.gitignore`ì— ì¶”ê°€**:

```gitignore
# .gitignore
.env
.env.local
.env.*.local
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

### 1. SQL Editor ì—´ê¸°

ì¢Œì¸¡ ë©”ë‰´ **SQL Editor** â†’ **New query** í´ë¦­

### 2. ê²°ì œ ì‹œìŠ¤í…œ í…Œì´ë¸” ìƒì„±

`docs/TOSS_PAYMENTS_INTEGRATION.md` íŒŒì¼ì˜ SQL ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬

ë˜ëŠ” `supabase/migrations/` í´ë”ì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì‹¤í–‰

```sql
-- 1. users í…Œì´ë¸” í™•ì¥
ALTER TABLE users
ADD COLUMN subscription_tier VARCHAR(20) DEFAULT 'free',
ADD COLUMN subscription_status VARCHAR(20) DEFAULT 'inactive',
-- ... (ì „ì²´ SQLì€ TOSS_PAYMENTS_INTEGRATION.md ì°¸ì¡°)
```

### 3. Run ë²„íŠ¼ í´ë¦­

SQL ì‹¤í–‰ í›„ ì„±ê³µ ë©”ì‹œì§€ í™•ì¸

### 4. Table Editorì—ì„œ í…Œì´ë¸” í™•ì¸

ì¢Œì¸¡ ë©”ë‰´ **Table Editor** â†’ ìƒì„±ëœ í…Œì´ë¸” í™•ì¸:
- `products`
- `payments`
- `subscriptions`
- `subscription_payments`
- `webhook_events`

---

## ë¡œì»¬ í™˜ê²½ ì„¤ì •

### 1. Supabase CLI ì„¤ì¹˜

```bash
# macOS (Homebrew)
brew install supabase/tap/supabase

# npm (ëª¨ë“  OS)
npm install -g supabase

# ì„¤ì¹˜ í™•ì¸
supabase --version
```

### 2. Supabase ë¡œê·¸ì¸

```bash
supabase login
```

ë¸Œë¼ìš°ì €ì—ì„œ ìë™ìœ¼ë¡œ ì¸ì¦ í˜ì´ì§€ ì—´ë¦¼ â†’ ìŠ¹ì¸

### 3. í”„ë¡œì íŠ¸ ì—°ê²°

```bash
cd /Users/seunghan/mbti_luck

# í”„ë¡œì íŠ¸ ì—°ê²°
supabase link --project-ref YOUR_PROJECT_REF

# ì˜ˆì‹œ:
# supabase link --project-ref rmqsukldnmileszpndgh
```

**Project Ref í™•ì¸ ë°©ë²•**:
- Supabase ëŒ€ì‹œë³´ë“œ â†’ Settings â†’ General
- Project Reference ID ë³µì‚¬

### 4. ì—°ê²° í™•ì¸

```bash
supabase status
```

ì¶œë ¥ ì˜ˆì‹œ:
```
         API URL: https://YOUR_PROJECT_REF.supabase.co
          DB URL: postgresql://...
      Studio URL: https://supabase.com/dashboard/project/YOUR_PROJECT_REF
    Inbucket URL: http://...
```

### 5. Flutter í”„ë¡œì íŠ¸ì— Supabase ì´ˆê¸°í™”

`lib/core/config/supabase_config.dart` ìƒì„±:

```dart
import 'package:supabase_flutter/supabase_flutter.dart';
import 'package:flutter_dotenv/flutter_dotenv.dart';

class SupabaseConfig {
  static Future<void> initialize() async {
    await Supabase.initialize(
      url: dotenv.env['SUPABASE_URL']!,
      anonKey: dotenv.env['SUPABASE_ANON_KEY']!,
    );
  }
}

// ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
final supabase = Supabase.instance.client;
```

`lib/main.dart`ì—ì„œ ì´ˆê¸°í™”:

```dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // .env íŒŒì¼ ë¡œë“œ
  await dotenv.load(fileName: '.env');

  // Supabase ì´ˆê¸°í™”
  await SupabaseConfig.initialize();

  runApp(MyApp());
}
```

---

## í”„ë¡œì íŠ¸ ì„¤ì • ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… ì™„ë£Œ í™•ì¸

- [ ] Supabase ê³„ì • ìƒì„±
- [ ] ìƒˆ í”„ë¡œì íŠ¸ ìƒì„± (ì„œìš¸ ë¦¬ì „)
- [ ] Database Password ì•ˆì „í•˜ê²Œ ì €ì¥
- [ ] Project URL ë³µì‚¬
- [ ] anon key ë³µì‚¬
- [ ] service_role key ë³µì‚¬
- [ ] `.env` íŒŒì¼ ìƒì„± ë° í‚¤ ì €ì¥
- [ ] `.gitignore`ì— `.env` ì¶”ê°€
- [ ] ê²°ì œ ì‹œìŠ¤í…œ í…Œì´ë¸” ìƒì„± (SQL ì‹¤í–‰)
- [ ] Supabase CLI ì„¤ì¹˜
- [ ] ë¡œì»¬ í”„ë¡œì íŠ¸ ì—°ê²°
- [ ] Flutter ì•±ì—ì„œ Supabase ì´ˆê¸°í™”

---

## ë¬´ë£Œ í”Œëœ ì œí•œì‚¬í•­

Supabase ë¬´ë£Œ í”Œëœì˜ ì£¼ìš” ì œí•œ:

| í•­ëª© | ë¬´ë£Œ í”Œëœ | Pro í”Œëœ |
|------|----------|---------|
| **í”„ë¡œì íŠ¸ ìˆ˜** | ì¡°ì§ë‹¹ 2ê°œ | ë¬´ì œí•œ |
| **ë°ì´í„°ë² ì´ìŠ¤** | 500MB | 8GB |
| **íŒŒì¼ ìŠ¤í† ë¦¬ì§€** | 1GB | 100GB |
| **ì›”ê°„ ëŒ€ì—­í­** | 5GB | 250GB |
| **Edge Functions** | 500K í˜¸ì¶œ/ì›” | 2M í˜¸ì¶œ/ì›” |
| **ì¼ì‹œ ì¤‘ì§€** | 7ì¼ ë¹„í™œì„± ì‹œ | ì—†ìŒ |

âš ï¸ **ë¬´ë£Œ í”„ë¡œì íŠ¸ëŠ” 7ì¼ ë™ì•ˆ í™œë™ì´ ì—†ìœ¼ë©´ ìë™ìœ¼ë¡œ ì¼ì‹œ ì¤‘ì§€ë©ë‹ˆë‹¤.**
- ëŒ€ì‹œë³´ë“œ ì ‘ì† ë˜ëŠ” API í˜¸ì¶œë¡œ ì¬í™œì„±í™” ê°€ëŠ¥

---

## ë‹¤ìŒ ë‹¨ê³„

1. âœ… **Supabase í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ**
2. â³ **Edge Functions ë°°í¬** ([DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md) ì°¸ì¡°)
3. â³ **í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ í…ŒìŠ¤íŠ¸**
4. â³ **Flutter ì•± ê²°ì œ ê¸°ëŠ¥ êµ¬í˜„**

---

## ë¬¸ì œ í•´ê²°

### Q: í”„ë¡œì íŠ¸ê°€ ìƒì„±ë˜ì§€ ì•Šì•„ìš”
- ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí–ˆëŠ”ì§€ í™•ì¸
- ë¬´ë£Œ í”Œëœì€ ì¡°ì§ë‹¹ 2ê°œ í”„ë¡œì íŠ¸ ì œí•œ
- ê¸°ì¡´ í”„ë¡œì íŠ¸ ì‚­ì œ í›„ ì¬ì‹œë„

### Q: API í‚¤ê°€ ë³´ì´ì§€ ì•Šì•„ìš”
- Settings â†’ API ë©”ë‰´ í™•ì¸
- í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œë„

### Q: Database Passwordë¥¼ ìŠì–´ë²„ë ¸ì–´ìš”
- Settings â†’ Database â†’ Database Settings
- "Reset database password" í´ë¦­
- ìƒˆ ë¹„ë°€ë²ˆí˜¸ ìƒì„± ë° ì €ì¥

### Q: SQL ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•´ìš”
- í…Œì´ë¸”ì´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
- SQL ë¬¸ë²• ì˜¤ë¥˜ í™•ì¸
- Logs ë©”ë‰´ì—ì„œ ìƒì„¸ ì˜¤ë¥˜ í™•ì¸

---

**ì‘ì„±ì¼**: 2026-01-01
**ë²„ì „**: 1.0.0
